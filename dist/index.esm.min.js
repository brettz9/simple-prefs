function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function n(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var i=function(){function t(r){e(this,t),this.configurePrefs(r),this.listeners=[]}return r(t,[{key:"configurePrefs",value:function(e){var t=e.namespace,r=e.defaults,n=e.prefDefaults,i=void 0===n?a(r):n;Object.assign(this,{namespace:t,prefDefaults:i})}},{key:"getPref",value:function(e){try{var t=localStorage.getItem(this.namespace+e);return n(null===t?this.prefDefaults.getPrefDefault(e):JSON.parse(t),void 0,!(null===t))}catch(e){return Promise.reject(e)}}},{key:"setPref",value:function(e,t){try{return n(localStorage.setItem(this.namespace+e,JSON.stringify(t)))}catch(e){return Promise.reject(e)}}},{key:"bind",value:function(){return{getPref:this.getPref.bind(this),setPref:this.setPref.bind(this)}}},{key:"listen",value:function(e,t){var r=this;"function"==typeof e&&(t=e,e=void 0);var n=function(n){if(null===n.key){if(void 0===e)return}else{if(!n.key.startsWith(r.namespace))return;if(void 0!==e&&!n.key.startsWith(r.namespace+e))return}t(n)};return window.addEventListener("storage",n),this.listeners.push(n),n}},{key:"unlisten",value:function(e){if(e)for(var t=0;t<this.listeners.length;t++)if(e===this.listeners[t])return this.listeners.splice(t,1),void window.removeEventListener("storage",e);this.listeners.forEach((function(e){window.removeEventListener("storage",e)}))}}]),t}(),s=function(){function t(r){var n=r.defaults;e(this,t),this.defaults=n}return r(t,[{key:"getPrefDefault",value:function(e){try{return n(this.defaults[e])}catch(e){return Promise.reject(e)}}},{key:"setPrefDefault",value:function(e,t){try{var r=this.defaults[e];return this.defaults[e]=t,n(r)}catch(e){return Promise.reject(e)}}}]),t}();function a(e){return new s({defaults:e})}export{i as SimplePrefs,s as SimplePrefsDefaults,a as simplePrefsDefaults};
//# sourceMappingURL=index.esm.min.js.map
